
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–ª–∏—Ç–∫–∏</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Yandex.Maps -->
  <script src="https://api-maps.yandex.ru/2.1/?apikey=a181d434-9dec-492b-8838-73ec5df31ebb&lang=ru_RU"></script>

  <!-- Dadata -->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/suggestions-jquery@latest/dist/js/jquery.suggestions.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/suggestions-jquery@latest/dist/css/suggestions.min.css" />
<style>
  .btn {
    padding: 10px 18px;
    border: none;
    border-radius: 8px;
    font-size: 15px;
    cursor: pointer;
    transition: 0.3s ease;
  }
  .btn.primary { background: #3459e6; color: white; }
  .btn.success { background: #0b8e2d; color: white; }
  .btn.outline { background: transparent; border: 1px solid #999; color: #333; }

  .btn:hover { opacity: 0.9; }

  label.checkbox {
    display: flex;
    align-items: center;
    gap: 8px;
    margin: 6px 0;
    cursor: pointer;
  }
</style>

  <style>
    body {
      font-family: 'Roboto', sans-serif;
      margin: 20px;
      color: #333;
    }
    input, select {
      padding: 8px;
      font-size: 15px;
      width: 100%;
      max-width: 400px;
      margin-bottom: 12px;
      box-sizing: border-box;
    }
    label {
      font-weight: bold;
      display: block;
      margin-top: 10px;
    }
    #map {
      width: 100%;
      height: 400px;
      margin-top: 10px;
      border-radius: 6px;
    }
    fieldset {
      border: 1px solid #ccc;
      padding: 20px;
      border-radius: 8px;
      background: #f9f9f9;
      margin-top: 20px;
    }
    button {
      background: #1e2d7d;
      color: white;
      padding: 10px 16px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      margin: 6px 6px 6px 0;
    }
    button:hover {
      background: #0e1a5d;
    }
    #delivery_result {
      margin-top: 20px;
      padding: 15px;
      border-left: 5px solid #1e2d7d;
      background: #eef3ff;
      border-radius: 6px;
    }
  </style>
</head>
<body>

<h1>–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –¥–æ—Å—Ç–∞–≤–∫–∏ –ø–ª–∏—Ç–∫–∏</h1>

<div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 30px;">
  <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: —Ñ–æ—Ä–º–∞ -->
  <div style="flex: 1; min-width: 320px; max-width: 500px;">
    <label for="address"><b>–í–≤–µ–¥–∏—Ç–µ –∞–¥—Ä–µ—Å –∏–ª–∏ –∫–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –∫–∞—Ä—Ç–µ:</b></label>
    <input type="text" id="address" placeholder="–Ω–∞–ø—Ä–∏–º–µ—Ä, –≥. –ú–æ—Å–∫–≤–∞, —É–ª. –õ–µ–Ω–∏–Ω–∞ 10" style="width: 100%; margin-bottom: 15px;">

    <form id="deliveryForm">
     <fieldset class="form-block">
  <legend>–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ—Å—Ç–∞–≤–∫–∏</legend>

  <div class="form-row">
    <label for="weight_standard">–í–µ—Å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –ø–ª–∏—Ç–∫–∏ (–∫–≥):</label>
    <input type="number" id="weight_standard" min="0" step="1">
  </div>

  <div class="form-row">
    <label for="weight_large">–í–µ—Å –∫—Ä—É–ø–Ω–æ–π –ø–ª–∏—Ç–∫–∏ (–∫–≥):</label>
    <input type="number" id="weight_large" min="0" step="1">
  </div>

  <div class="form-row">
    <label for="loading_type">–¢–∏–ø –∑–∞–≥—Ä—É–∑–∫–∏:</label>
    <select id="loading_type">
      <option value="–ª—é–±–∞—è">–õ—é–±–∞—è</option>
      <option value="–≤–µ—Ä—Ö–Ω—è—è">–í–µ—Ä—Ö–Ω—è—è</option>
      <option value="–±–æ–∫–æ–≤–∞—è">–ë–æ–∫–æ–≤–∞—è</option>
      <option value="–≥–∏–¥—Ä–æ–ª–∏—Ñ—Ç">–ì–∏–¥—Ä–æ–ª–∏—Ñ—Ç</option>
      <option value="manipulator">–ú–∞–Ω–∏–ø—É–ª—è—Ç–æ—Ä</option>
    </select>
  </div>

  <div class="form-check">
    <label><input type="checkbox" id="return_pallets"> –í–æ–∑–≤—Ä–∞—Ç —Ç–∞—Ä—ã</label>
  </div>
  <div class="form-check">
    <label><input type="checkbox" id="underground"> –ü–æ–¥–∑–µ–º–Ω—ã–π –ø–∞—Ä–∫–∏–Ω–≥</label>
  </div>
  <div class="form-check">
    <label><input type="checkbox" id="precise_time"> –î–æ—Å—Ç–∞–≤–∫–∞ –∫ —Ç–æ—á–Ω–æ–º—É –≤—Ä–µ–º–µ–Ω–∏</label>
  </div>
  <div class="form-check">
    <label><input type="checkbox" id="need_movers"> –ù—É–∂–Ω—ã –≥—Ä—É–∑—á–∏–∫–∏</label>
  </div>
</fieldset>


   <div style="display: flex; gap: 12px; margin-top: 15px; flex-wrap: wrap;">
  <button type="button" onclick="saveFormData()" class="btn primary">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã</button>
  <button type="button" onclick="calculateDelivery()" class="btn success">üì¶ –†–∞—Å—Å—á–∏—Ç–∞—Ç—å —Å—Ç–æ–∏–º–æ—Å—Ç—å</button>
  <button type="button" onclick="openAdmin()" class="btn outline">üõ†Ô∏è –ê–¥–º–∏–Ω–∫–∞</button>
</div>
</form>
</div>


  <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞: –∫–∞—Ä—Ç–∞ -->
  <div id="map" style="flex: 1; min-width: 320px; height: 500px; border-radius: 6px;"></div>
</div>

</form>

<div id="delivery_result"></div>

<script>
  const warehouse = [54.907129, 38.054109];
  let clientPlacemark = null;
  let routeLine = null;
  let formData = {};

  ymaps.ready(() => {
const map = new ymaps.Map("map", {
  center: warehouse,
  zoom: 9,
  controls: [] // <== ‚õî –æ—Ç–∫–ª—é—á–∞–µ—Ç –í–°–ï –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –∫–æ–Ω—Ç—Ä–æ–ª—ã, –≤–∫–ª—é—á–∞—è –ø–æ–∏—Å–∫
});


    const warehousePlacemark = new ymaps.Placemark(warehouse, {
      balloonContent: "–°–∫–ª–∞–¥"
    }, {
      preset: "islands#redIcon",
      iconCaption: "–°–∫–ª–∞–¥"
    });
    map.geoObjects.add(warehousePlacemark);

    map.events.add("click", e => {
      const coords = e.get("coords");
      setClientPoint(coords);
    });

    $("#address").suggestions({
      token: "53d32f43f22df54e47727e3ba091627532e7cda5",
      type: "ADDRESS",
      onSelect: function (suggestion) {
        ymaps.geocode(suggestion.value).then(res => {
          const coords = res.geoObjects.get(0).geometry.getCoordinates();
          setClientPoint(coords);
          map.setCenter(coords, 12);
        });
      }
    });

    function setClientPoint(coords) {
      if (clientPlacemark) map.geoObjects.remove(clientPlacemark);
      if (routeLine) map.geoObjects.remove(routeLine);

      clientPlacemark = new ymaps.Placemark(coords, {
        balloonContent: "–ö–ª–∏–µ–Ω—Ç"
      }, {
        preset: "islands#greenIcon",
        iconCaption: "–ö–ª–∏–µ–Ω—Ç"
      });
      map.geoObjects.add(clientPlacemark);

      ymaps.route([warehouse, coords], { routingMode: "auto" }).then(route => {
        routeLine = route;
        map.geoObjects.add(routeLine);
        const distanceKm = route.getLength() / 1000;
        window.deliveryDistance = distanceKm;
      }, () => {
        alert("–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç");
      });
    }
  });

  function addLargeFormatRow() {
    const tbody = document.querySelector("#large_format_table tbody");
    const row = document.createElement("tr");

    const formatCell = document.createElement("td");
    const select = document.createElement("select");
    const formats = [
      "", "100x200", "100x260", "100x280", "100x290", "100x295", "100x299", "100x300",
      "120x240", "120x278", "120x280", "120x300",
      "159x324", "160x320", "162x324", "80x324"
    ];
    formats.forEach(f => {
      const option = document.createElement("option");
      option.value = f;
      option.textContent = f || "–í—ã–±–µ—Ä–∏—Ç–µ";
      select.appendChild(option);
    });
    formatCell.appendChild(select);

    const qtyCell = document.createElement("td");
    const qtyInput = document.createElement("input");
    qtyInput.type = "number";
    qtyInput.min = "1";
    qtyInput.style.width = "60px";
    qtyCell.appendChild(qtyInput);

    const deleteCell = document.createElement("td");
    const btn = document.createElement("button");
    btn.textContent = "‚úñ";
    btn.type = "button";
    btn.onclick = () => row.remove();
    deleteCell.appendChild(btn);

    row.appendChild(formatCell);
    row.appendChild(qtyCell);
    row.appendChild(deleteCell);
    tbody.appendChild(row);
  }

  function saveFormData() {
    const largeSheets = [];
    document.querySelectorAll("#large_format_table tbody tr").forEach(row => {
      const format = row.querySelector("select").value;
      const count = row.querySelector("input").value;
      if (format && count) {
        largeSheets.push({ format, count });
      }
    });

    formData = {
      weight_standard: parseInt(document.getElementById("weight_standard").value) || 0,
      weight_large: parseInt(document.getElementById("weight_large").value) || 0,
      loading_type: document.getElementById("loading_type").value,
      return_pallets: document.getElementById("return_pallets").checked,
      underground: document.getElementById("underground").checked,
      height_limit: document.getElementById("height_limit").value,
      precise_time: document.getElementById("precise_time").checked,
      delivery_time: document.getElementById("delivery_time").value,
      need_movers: document.getElementById("need_movers").checked,
      only_unload: document.querySelector("input[name='only_unload']:checked").value,
      floor: document.getElementById("floor").value,
      lift: document.querySelector("input[name='lift']:checked").value,
      large_sheets: largeSheets,
      deliveryDistance: window.deliveryDistance || 0
    };

    window.formData = formData;
    alert("–ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!");
  }
</script>

<script src="delivery.js"></script>
  <footer style="margin-top:40px; font-size: 11px; color: rgba(0,0,0,0.3); text-align: center;">
  –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –ì–µ–Ω–Ω–∞–¥–∏–µ–º –ë–∞–π–∫–æ–≤—ã–º, –û–û–û ¬´–°–µ—Ä–≤–∏—Å–ö–µ—Ä–∞–º–∏–∫–∞¬ª <a href="https://sceramic.ru" style="color: rgba(0,0,0,0.3); text-decoration: none;">sceramic.ru</a>
</footer>

</body>
</html>
